doctype 5
html
  head
    title Groonga CloudSearch
    // script(src="/js/gcs.min.js", type="text/javascript")
    script(src="/js/lib/jquery-1.8.2.min.js", type="text/javascript")
    script(src="/js/lib/bootstrap.js", type="text/javascript")
    script(src="/js/lib/handlebars-1.0.rc.1.js", type="text/javascript")
    script(src="/js/lib/ember-latest.js", type="text/javascript")
    script(src="/js/lib/ember-data-latest.js", type="text/javascript")
    script(src="/js/gcs/base.js", type="text/javascript")
    script(src="/js/gcs/controllers.js", type="text/javascript")
    script(src="/js/gcs/models.js", type="text/javascript")
    script(src="/js/gcs/router.js", type="text/javascript")
    script(src="/js/gcs/views.js", type="text/javascript")
    // link(href="/css/gcs.min.css", rel="stylesheet")
    link(href="/css/bootstrap.css", rel="stylesheet")
    link(href="/css/gcs.css", rel="stylesheet")

    script(data-template-name="application", type="text/x-handlebars")
      .navbar.navbar-fixed-top
        .navbar-inner
          .container
            <a class="brand" href {{action gotoIndex}}>Groonga CloudSearch</a>
      .container
        .row
          .span2
            .well(style="padding: 10px 0 10px 0;")
              ul.nav.nav-list
                {{#view view.NavItemView section="Home" item=null}}
                <a href {{action gotoIndex this}}><i class="icon-home"></i> Home</a>
                {{/view}}
                li.nav-header Domains
                {{#each App.domains}}
                {{#view view.NavItemView section="Domain" itemBinding="name"}}
                <a href {{action gotoDomainShow this}}><i class="icon-hdd"></i> {{name}}</a>
                {{/view}}
                {{/each}}
                {{#view view.NavItemView section="DomainCreate"}}
                <a href {{action gotoDomainCreate}}><i class="icon-plus"></i> New domain</a>
                {{/view}}
          .span10
            {{outlet}}

    script(data-template-name="index", type="text/x-handlebars")
      h1 Global Configuration
      table.table.table-bordered
        tbody
          tr
            th Configuration Endpoint
            td {{App.configurationEndpoint}}

    script(data-template-name="domain", type="text/x-handlebars")
      h1 Domain '{{name}}'

      ul.nav.nav-tabs
        {{#view view.NavItemView item="About"}}
        <a href {{action gotoDomainShow this.content}}>About</a>
        {{/view}}
        {{#view view.NavItemView item="Search"}}
        <a href {{action gotoDomainSearch this.content}}>Search</a>
        {{/view}}
        <a href {{action delete}} class="pull-right"><i class="icon-remove"></i> Delete</a>

      {{outlet}}

    script(data-template-name="domain-show", type="text/x-handlebars")
      table.table.table-bordered
        tbody
          tr
            th Document Service Endpoint
            td {{docEndpoint}}
          tr
            th Search Service Endpoint
            td {{searchEndpoint}}
          tr
            th Fields
            td
              ul
                {{#each indexFields}}
                li {{name}}
                {{/each}}

    script(data-template-name="domain-create", type="text/x-handlebars")
      h1 Creating new domain

      {{#view view.DomainCreateFormView}}
      .control-group
        label.control-label Domain Name
        .controls
          {{view Ember.TextField valueBinding="domainName"}}
      .control-group
        .controls
          <button class="btn btn-primary" {{action createAndShow}}>Create</button>
      {{/view}}

    script(data-template-name="domain-search", type="text/x-handlebars")
      {{#view view.SearchFormView}}
      {{view Ember.TextField valueBinding="query"}}
      input(type="hidden", name="start", value="")
      button(type="submit", class="btn") Search
      {{/view}}

      p
        span Query: 
        strong {{query}}

      p View raw:
        <a target="_blank" {{bindAttr href="urlForRawRequest"}}>{{urlForRawRequest}}</a>

      {{#if searched}}
      {{#if resultsAvailable}}
      .alert.alert-info Showing {{numStart}} to {{numEnd}} of {{numHits}} results
      {{else}}
      .alert.alert-info Record not found
      {{/if}}
      {{/if}}

      {{#if resultsAvailable}}
      //- DOM structure of this table seems to be broken. The issue https://github.com/wycats/handlebars.js/issues/184 may be related with this.
      ul.pager
        {{#if previousPageAvailable}}
        li.previous
          <a class="previous" {{action previousPage}}>&larr; Previous</a>
        {{else}}
        li.previous.disabled
          a &larr; Previous
        {{/if}}
        {{#if nextPageAvailable}}
        li.next
          <a class="next" {{action nextPage}}>Next &rarr;</a>
        {{else}}
        li.next.disabled
          a Next &rarr;
        {{/if}}

      table.table.table-bordered
        tbody
          {{#each controller}}
          tr.id-row
            td {{index}}
            td.id-cell(colspan=2) {{id}}
          {{#each data}}
          tr
            td
            td {{columnName}}
            td {{value}}
          {{/each}}
          {{/each}}
      {{/if}}
  body
