#!/usr/bin/env node

var CLI = require(__dirname + '/../lib/command-line').CommandLineInterface;
var commandLine = new CLI();

commandLine
  .usage('--domain-name <domain name> [options]')
  .option('-d, --domain-name <domain name>',
          'The name of the domain that you are creating. Required.',
          String)
  .parse();

commandLine.assertHaveDomainName();

var domainName = commandLine.domainName;
commandLine.getDomainStatus(domainName, function(error, domain) {
  if (domain) {
    console.log('The domain [' + domainName + '] already exists.');
    return process.exit(1);
  }
  console.log('Creating domain [' + domainName + ']');
  commandLine.cloudSearch.CreateDomain(
    { DomainName: domainName },
    function(error, result) {
      if (error)
        commandLine.raiseFatalError(error);
      console.log('Domain endpoints are currently being created. ' +
                  'Use gcs-describe-domain to check for endpoints.');
      process.exit(0);
    }
  );
});
