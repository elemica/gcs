#!/usr/bin/env node

var program = require('commander');
var commandLine = require(__dirname + '/../lib/command-line');

program
  .version(require('../package').version)
  .usage('[options]')
  .option('-d, --domain-name <domain name>',
          'The name of the domain that you are creating. Required.',
          String)
  .option('-all, --show-all',
          'Display all available information for the domain, '
             + 'including configured fields.',
          String)
  .option('--database-path <path>',
          'database path [' + commandLine.defaultDatabasePath + ']',
          String,
          commandLine.defaultDatabasePath)
  .parse(process.argv);

function report(domain) {
  console.log('Domain Name               %s', domain.name);
  console.log('Document Service Endpoint %s', domain.getDocumentsEndpoint('localhost'));
  console.log('Search Endpoint           %s', domain.getSearchEndpoint('localhost'));
  console.log('Searchable Documents      %s', domain.searchableDocumentsCount);
  console.log('Index Fields              %s', domain.name);
//  console.log('Ranking Fields            %s', ;
  console.log('SearchPartitionCount      %s', domain.searchPartitionCount);
  console.log('SearchInstanceCount       %s', domain.searchInstanceCount);
  console.log('SearchInstanceType        %s', domain.searchInstanceType);
}

var context = commandLine.getContext(program.databasePath);
if (program.domainName) {
  var domain = new commandLine.Domain(program.domainName, context);
  report(domain);
} else {
  var domains = commandLine.Domain.getAll(context);
  domains.forEach(function(domain, index) {
    if (index) console.log('========================================');
    report(domain);
  });
}
