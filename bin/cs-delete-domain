#!/usr/bin/env node

var program = require('commander');
var CLI = require(__dirname + '/../lib/command-line').CommandLineInterface;
var commandLine = new CLI(program);

program
  .version(require('../package').version)
  .usage('--domain-name <domain name> [options]')
  .option('-d, --domain-name <domain name>',
          'The name of the domain that you are deleting. Required.',
          String)
  .option('-f, --force',
          'Delete the domain without prompting for confirmation.')
  .option('--database-path <path>',
          'database path [' + CLI.defaultDatabasePath + ']',
          String,
          CLI.defaultDatabasePath)
  .parse(process.argv);

commandLine.assertHaveDomainName();
commandLine.assertDomainExists();

if (program.force) {
  commandLine.domain.deleteSync();
  console.log('Domain [' + commandLine.domain.name + '] has been deleted successfully.');
} else {
  program.confirm('Really delete? [' + commandLine.domain.name + '] (y/N)', function(ok){
    if (ok) {
      commandLine.domain.deleteSync();
      console.log('Successfully deleted.');
      process.exit(0);
    } else {
      process.exit(1);
    }
  });
}
