#!/usr/bin/env node

var gcsServer = require(__dirname + '/../lib/server');
var CLI = require(__dirname + '/../lib/command-line').CommandLineInterface;
var commandLine = new CLI();

commandLine
  .option('-p, --port <port>',
          'specify port [7575]',
          Number,
          7575)
  .option('--privilege <ip range>',
          'list of IP ranges for privileged client '+
            '[' + CLI.defaultPrivilegedRanges + ']',
          String,
          CLI.defaultPrivilegedRanges)
  .parse();

var server = gcsServer.createServer({
      databasePath:     commandLine.options.databasePath,
      privilegedRanges: commandLine.options.privilege,
      port:             commandLine.options.port
    });

server.listen(commandLine.options.port, function() {
  console.log('gcs listening at %d', commandLine.options.port);
  console.log('database is at %s', commandLine.options.databasePath);
  console.log('privileged IP ranges are %s', commandLine.options.privilege);
});
