#!/usr/bin/env node

var gcsServer = require(__dirname + '/../lib/server');
var program = require('commander');
var commandLine = require(__dirname + '/../lib/command-line');

program
  .version(require('../package').version)
  .usage('[options]')
  .option('-p, --port <port>',
          'specify port [7575]',
          Number,
          7575)
  .option('--database-path <path>',
          'database path [' + commandLine.defaultDatabasePath + ']',
          String,
          commandLine.defaultDatabasePath)
  .option('--privilege <ip range>',
          'list of IP ranges for privileged client '+
            '[' + commandLine.defaultPrivilegedRanges + ']',
          String,
          commandLine.defaultPrivilegedRanges)
  .parse(process.argv);

var server;

server = gcsServer.createServer({
  databasePath:     program.databasePath,
  privilegedRanges: program.privilege
});

server.listen(program.port, function() {
  console.log('gcs listening at %d', program.port);
  console.log('database is at %s', program.databasePath);
  console.log('privileged IP ranges are %s', program.privilege);
});
